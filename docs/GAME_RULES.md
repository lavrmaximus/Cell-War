# Cell War - Полные правила игры

## Основные понятия

### Игровые сущности

**Клетка (Cell)** - базовый элемент игрового поля. Может быть:
- **Пустая** - нейтральная территория
- **Захваченная** - принадлежит игроку
- **Особая местность** - влияет на стоимость захвата

**Игрок (Player)** - участник игры. Имеет:
- **Цвет** - идентификатор территории
- **Золото** - игровая валюта
- **Доход** - золото за ход
- **Территория** - количество захваченных клеток

## Игровой процесс

### Начало игры
1. Каждый игрок получает стартовую территорию 3x3 клетки
2. Начальный капитал: 10 золота
3. Игроки ходят по очереди

### Структура хода
1. **Фаза дохода** - получение золота со всех ферм
2. **Фаза действий** - выполнение действий (ограничено золотом)
3. **Фаза проверки** - проверка целостности территорий

## Действия игрока

### Захват клеток
- **Нейтральная клетка**: 1 золото
- **Вражеская клетка**: стоимость = защита + 1 золото
- **Особая местность**: дополнительная стоимость
  - Холм: +1 золото (всего 2)
  - Гора: непроходима
  - Вода: непроходима

**Ограничение**: можно захватывать только клетки, соседние с текущей территорией

### Строительство ферм
- Ферма производит 1 золото за ход
- Стоимость зависит от количества построенных ферм:
  - 1-10 ферм: 1 золото
  - 11-20 ферм: 2 золота
  - 21-30 ферм: 3 золота
  - и т.д.

**Ограничение**: ферму можно строить только на пустой клетке своей территории

### Усиление защиты
- Можно вложить любое количество золота (1-9) в защиту клетки
- Защита увеличивает стоимость захвата для противника
- Формула захвата защищённой клетки: защита + 1 золото

**Ограничение**: защиту можно ставить только на пустые клетки

## Экономическая система

### Доход
- Каждая ферма приносит 1 золото за ход
- Доход рассчитывается в начале хода
- Золото накапливается, если не тратится

### Стоимость ферм
Количество ферм | Стоимость постройки
1-10 | 1 золото
11-20 | 2 золота
21-30 | 3 золота
31-40 | 4 золота
41-50 | 5 золота

## Территориальная механика

### Целостность территории
- Все клетки игрока должны быть соединены с основной территорией
- Соединение считается через соседние клетки (горизонтально/вертикально)

### Колонии
- Отрезанная от основной территории область становится колонией
- **Колония с фермами**: выживает, приносит доход, может действовать
- **Колония без ферм**: исчезает через 1 ход

### Процесс отрезания территории
1. Игрок захватывает клетку, разрывающую связь противника
2. Отрезанная область становится колонией
3. Если в колонии нет ферм - начинается отсчёт до исчезновения
4. У defending игрока есть 1 ход чтобы восстановить связь

## Особые клетки

### Горы (■)
- Непроходимы
- Нельзя захватить
- Создают естественные барьеры

### Вода/Реки (≈) 
- Непроходимы
- Нельзя захватить
- Разделяют карту на зоны

### Холмы (△)
- Проходимы
- Стоимость захвата: 2 золота
- Дают тактическое преимущество

## Условия победы

### Основные условия
1. **Уничтожение противника** - захват всех клеток противника
2. **Экономическое доминирование** - уничтожение всех ферм противника
3. **Сдача** - игрок добровольно сдается

### Дополнительные условия
- **Тайм-аут** - после N ходов побеждает игрок с большей территорией
- **Ничья** - при равном количестве территории и ферм

## Расширенные механики

### Горячие клавиши (управление)
Q - Выбрать действие "Захват"
W - Выбрать действие "Построить ферму"
E - Выбрать действие "Усилить защиту"
R - Завершить ход

### Визуальные индикаторы
- **Подсветка** - доступные для действия клетки
- **Предпросмотр** - результат действия при наведении
- **Полупрозрачность** - визуализация будущего состояния

### Анимации
- **Захват клетки**: вспышка белым → плавное заполнение цветом
- **Получение дохода**: монетки летят от ферм к счетчику золота
- **Потеря территории**: мигание перед исчезновением

## Балансировочные ограничения

### Анти-снежный ком
- Рост стоимости ферм предотвращает бесконечное расширение
- Лимит на захват клеток за ход (только соседние)
- Механика колоний предотвращает "щупальца"

### Стратегический выбор
Игрок всегда стоит перед дилеммой:
- Инвестировать в экономику (фермы)
- Инвестировать в безопасность (защита) 
- Инвестировать в экспансию (захват территорий)

## Пример игровой сессии

### Ход 1 (Игрок А)
- Доход: 0 золота
- Действия: 
  - Захватывает 5 нейтральных клеток (5 золота)
  - Строит 5 ферм (5 золота)
- Итог: 14 клеток, 5 ферм, доход: 5

### Ход 2 (Игрок Б)
- Доход: 5 золота
- Действия:
  - Захватывает 2 клетки (2 золота)
  - Строит 1 ферму (2 золота, 6-я ферма)
- Итог: 16 клеток, 6 ферм, доход: 6

### Ход 3 (Игрок А)
- Доход: 5 золота
- Действия:
  - Усиливает защиту границы (3 золота)
  - Захватывает 1 клетку противника (защита 2 → 3 золота)
- Итог: прорыв обороны противника

## Особые случаи и исключения

### Одновременные действия
Если несколько игроков пытаются захватить одну клетку:
- Приоритет у игрока, чей ход сейчас
- Деньги тратятся, даже если действие невозможно
- Возврат средств только при технической ошибке

### Пограничные ситуации
- **Захват последней клетки**: мгновенная победа
- **Одновременное уничтожение**: ничья
- **Бесконечный цикл**: ограничение на количество ходов

---

*Эти правила являются основой для реализации игровой логики. Детали реализации могут уточняться в процессе разработки.*